<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover" />
  <title>WebHub</title>
  <meta name="theme-color" content="#0c0f14" />
  
  <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;500;900&display=swap" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Cal+Sans&display=swap" rel="stylesheet">
  
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg%20width%3D%271746%27%20height%3D%271745%27%20xmlns%3D%27http%3A//www.w3.org/2000/svg%27%20xmlns%3Axlink%3D%27http%3A//www.w3.org/1999/xlink%27%20xml%3Aspace%3D%27preserve%27%20overflow%3D%27hidden%27%3E%3Cdefs%3E%3CclipPath%20id%3D%27clip0%27%3E%3Crect%20x%3D%271327%27%20y%3D%27365%27%20width%3D%271746%27%20height%3D%271745%27/%3E%3C/clipPath%3E%3C/defs%3E%3Cg%20clip-path%3D%27url(%2523clip0)%27%20transform%3D%27translate(-1327%20-365)%27%3E%3Cpath%20d%3D%27M2311.86%201126.81C2291.45%201126.1%202270.58%201128.5%202249.85%201134.37%202139.26%201165.66%202074.17%201283.56%202104.49%201397.72%202165.11%201626.04%202393.55%201760.4%202614.74%201697.83%202808.27%201643.07%202932.12%201455.68%202919.44%201256.73L2914.05%201223.69%202911.9%201230.96%202911.08%201256.02C2900.38%201338.81%202843.04%201411%202760.1%201434.47%202649.5%201465.76%202535.28%201398.58%202504.97%201284.42%202480.35%201191.66%202400.32%201129.92%202311.86%201126.81ZM2004.92%20762.177C1728%20772.703%201498.32%20998.253%201480.1%201289.86%201470.39%201445.38%201584.65%201579.59%201735.31%201589.62%201885.97%201599.65%202015.98%201481.7%202025.7%201326.18%202035.42%201170.66%202165.43%201052.71%202316.09%201062.74%202410.26%201069.01%202490.2%201123.78%202534.55%201201.96L2541.96%201215.66C2546.43%201224.15%202552.28%201237.53%202562.41%201252.11L2568.21%201259%202567.3%201248.26C2532.46%20988.233%202324.54%20780.535%202060.89%20762.983%202042.06%20761.729%202023.38%20761.475%202004.92%20762.177ZM1327%20365%203073%20365%203073%202110%201327%202110Z%27%20fill%3D%27%23161B22%27%20fill-rule%3D%27evenodd%27/%3E%3C/g%3E%3C/svg%3E" />
  
  <style>
    /* --- Variables & Theme --- */
    :root{
      --bg-0:#0c0f14;
      --bg-1:#10141b;
      --bg-2:#161b22;
      --surface:#1f2630;
      --ink-0:#e6eaf0;
      --ink-1:#aeb6c2;
      --primary:#5b8cff;
      --primary-2:#2f6bff;
      --focus:#77b0ff;
      --shadow:rgba(0,0,0,.28);
      --border:rgba(255,255,255,.08);
      --border-strong:rgba(255,255,255,.12);
      --surface-hover:#232b36;
      --radius:12px;
      --radius-lg:16px;
      --maxw:1000px;
      color-scheme: dark light;
    }
    html[data-theme="light"]{
      --bg-0:#f6f8fb;
      --bg-1:#f1f4f9;
      --bg-2:#e9eef6;
      --surface:#ffffff;
      --ink-0:#0f172a;
      --ink-1:#4b5563;
      --primary:#2f6bff;
      --primary-2:#1f58f7;
      --focus:#1d4ed8;
      --shadow:rgba(0,0,0,.10);
      --border:rgba(2,6,23,.10);
      --border-strong:rgba(2,6,23,.16);
      --surface-hover:#f5f7fb;
      color-scheme: light;
    }

    /* --- Reset & Base --- */
    ::-webkit-scrollbar { display: none; }
    * { scrollbar-width: none; -ms-overflow-style: none; }

    .cal-sans-regular {
      font-family: "Cal Sans", sans-serif;
      font-weight: 400;
      font-style: normal;
      display: inline-block;
      vertical-align: middle;
    }
    html{
      height:100%;
      background-color:var(--bg-1);
      -webkit-tap-highlight-color:transparent;
      -webkit-text-size-adjust:100%;
      scroll-behavior:smooth;
      scrollbar-gutter: stable;
      overflow-y:auto;
      touch-action: manipulation; 
    }
    body{
      min-height:100%;
      font-family:'Noto Sans KR',sans-serif;
      margin:0; padding:0;
      background:linear-gradient(180deg,var(--bg-0) 0%, var(--bg-1) 100%);
      color:var(--ink-0);
      background-attachment:scroll;
      touch-action: manipulation;
      transition: background-color 0.3s ease, color 0.2s ease; 
    }
    body.scroll-lock { overflow:hidden; position:fixed; width:100%; }

    /* --- Transition Effects --- */
    header, .section, .input-shell, .link, .drawer-nav, .timer-btn, .engine-btn, footer {
      transition: background-color 0.3s ease, border-color 0.3s ease, color 0.2s ease, box-shadow 0.3s ease;
    }

    /* --- Header --- */
    header{
      position:fixed; top:0; left:0; right:0; z-index:1000;
      background:rgba(16,20,27,.78);
      backdrop-filter:saturate(120%) blur(8px);
      color:var(--ink-0);
      padding:10px 16px;
      border-bottom:1px solid var(--border-strong);
    }
    html[data-theme="light"] header{ background:rgba(241,244,249,.78); }
    .head-inner{
      max-width:var(--maxw); margin:0 auto;
      display:flex; align-items:center; gap:12px;
    }
    h1{
      font-size:24px; font-weight:900; margin:0;
      user-select:none; cursor:pointer; white-space:nowrap;
    }
    .brand-by{
      color:var(--ink-1);
      font-weight:300;
      font-size:14px;
      margin-left:4px;
    }
    .menu-toggle,
    .theme-toggle{
      display:inline-flex; align-items:center; justify-content:center;
      width:44px; height:40px; background:transparent;
      border:1px solid var(--border-strong); border-radius:10px; cursor:pointer;
      color:var(--ink-0);
    }
    .theme-toggle{ margin-left:auto; }
    .menu-toggle{ margin-left:6px; }
    @media (max-width:720px){
      .menu-toggle{ margin-left:4px; }
      .theme-toggle{ margin-left:auto; }
      .brand-by{ font-size:12px; margin-left:3px; }
    }

    /* --- Hamburger Icon --- */
    .hamburger{ width:22px; height:16px; position:relative; }
    .hamburger span{
      position:absolute; left:0; right:0; height:2px; background:var(--ink-0); border-radius:2px;
      transition:transform .2s ease, opacity .2s ease, top .2s ease;
    }
    .hamburger span:nth-child(1){ top:0; }
    .hamburger span:nth-child(2){ top:7px; }
    .hamburger span:nth-child(3){ top:14px; }
    .menu-toggle[aria-expanded="true"] .hamburger span:nth-child(1){ transform:none; }
    .menu-toggle[aria-expanded="true"] .hamburger span:nth-child(2){ opacity:1; }
    .menu-toggle[aria-expanded="true"] .hamburger span:nth-child(3){ transform:none; }
    .theme-toggle:hover{ background:rgba(255,255,255,.06); }
    html[data-theme="light"] .theme-toggle:hover{ background:rgba(2,6,23,.06); }

    /* --- Drawer Navigation --- */
    .drawer-root{ position:fixed; inset:0; z-index:1200; pointer-events:none; contain:layout paint; }
    .drawer-overlay{ position:absolute; inset:0; background:rgba(0,0,0,.5); backdrop-filter:blur(10px); opacity:0; transition:opacity .22s ease; }
    .drawer-nav{
      position:absolute; top:0; right:0; height:100dvh;
      width:320px; max-width:92vw; background:var(--bg-2);
      border-left:1px solid var(--border-strong);
      transform:translateX(100%); transition:transform .26s cubic-bezier(.2,.8,.2,1);
      display:flex; flex-direction:column; padding:16px;
      overflow-y:auto; -webkit-overflow-scrolling:touch;
      box-shadow:-12px 0 28px var(--shadow);
    }
    .drawer-nav h3{ margin:4px 0 12px; font-size:14px; color:var(--ink-1); font-weight:600; }
    .drawer-nav ul{ list-style:none; margin:0; padding:0; display:grid; gap:6px; }
    .drawer-nav a{
      display:flex; align-items:center; gap:10px;
      padding:10px 12px; border-radius:10px; color:var(--ink-0);
      text-decoration:none; background:rgba(255,255,255,.04);
      border:1px solid var(--border-strong);
    }
    html[data-theme="light"] .drawer-nav a{ background:rgba(255,255,255,.7); }
    .drawer-nav a:hover{ background:rgba(255,255,255,.12); }
    html[data-theme="light"] .drawer-nav a:hover{ background:#fff; }
    .drawer-root.active{ pointer-events:auto; }
    .drawer-root.active .drawer-overlay{ opacity:1; }
    .drawer-root.active .drawer-nav{ transform:translateX(0); }
    .drawer-close-btn {
      position: absolute; top: 10px; right: 10px; width: 40px; height: 40px;
      background: transparent; border: none; color: var(--ink-0);
      font-size: 24px; cursor: pointer; display: flex; align-items: center; justify-content: center;
    }

    /* --- Layout --- */
    main{
      max-width:var(--maxw);
      margin-left:auto;
      margin-right:auto;
      padding-top: 60px;
      padding-left: 7px;
      padding-right: 7px;
      box-sizing: border-box;
    }
    .section{
      margin:20px auto; background:linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.02));
      border:1px solid var(--border); border-radius:16px; box-shadow:0 8px 24px var(--shadow);
      overflow:hidden; text-align:center;
    }
    html[data-theme="light"] .section{
      background:linear-gradient(180deg, rgba(255,255,255,.96), rgba(255,255,255,.94));
      box-shadow:0 8px 18px var(--shadow);
    }
    .section-body{ padding:20px; }
    
    /* --- Clock --- */
    .time-text{ 
      display:flex; 
      align-items:center;
      justify-content:center;
      gap: 8px;
      font-size:18px; 
      line-height:1.45; 
      flex-wrap: wrap;
    }
    .time-text .t-date { display: inline-block; }
    .time-text .t-time { 
      display: inline-block;
      font-size: 18px; 
      font-weight: 900; 
      margin-top: 0;
    }

    .group-divider {
        border: 0;
        height: 1px;
        background: var(--border-strong);
        margin: 24px 0;
        opacity: 0.6;
    }

    /* --- Links --- */
    .link-grid{
      display:grid; gap:12px;
      grid-template-columns: repeat( auto-fit, minmax(220px, 1fr) );
    }
    .link-grid.grid-4{ grid-template-columns: repeat( auto-fit, minmax(180px, 1fr) ); }
    .link{
      display:flex; gap:10px; align-items:center; justify-content:center;
      background:var(--surface);
      border:1px solid var(--border-strong);
      border-radius:14px; padding:14px 12px; color:var(--ink-0); text-decoration:none;
      transition:transform .12s, background-color .3s, border-color .3s, color .3s;
      text-align:center;
    }
    .link:hover{
      transform:translateY(-2px);
      background:var(--surface-hover);
      border-color:color-mix(in oklab, var(--border-strong) 70%, var(--ink-0) 30%);
    }
    .link img{ width:16px; height:16px; border-radius:4px; object-fit:contain; }

    /* --- Search Engine --- */
    .search-wrap{ display:flex; flex-direction:column; gap:14px; }
    .engine-seg{
      display:flex; gap:8px; padding:8px;
      background:rgba(255,255,255,.04);
      border:1px solid var(--border);
      border-radius:12px; overflow:auto;
      scrollbar-width:none; -ms-overflow-style:none;
      justify-content:flex-start; -webkit-overflow-scrolling:touch;
      cursor: grab; user-select: auto;
    }
    html[data-theme="light"] .engine-seg{ background:rgba(255,255,255,.8); }
    .engine-seg::-webkit-scrollbar { display: none; }
    .engine-seg.dragging{ cursor: grabbing; user-select: none; -webkit-user-select: none; }

    .engine-btn{
      appearance:none; border:none; background:transparent; color:var(--ink-0);
      padding:8px 12px; border-radius:10px; cursor:pointer; white-space:nowrap;
      display:inline-flex; align-items:center; gap:8px; font-weight:700; font-size:13px;
      border:1px solid transparent;
      transition:background .15s ease, border-color .15s ease, color .15s ease, transform .1s ease;
      flex: 0 0 auto;
    }
    .engine-btn:hover{ transform:translateY(-1px); }
    .engine-btn[data-active="true"]{
      background:rgba(47,107,255,.15);
      border-color:rgba(47,107,255,.45);
      color:#ffffff;
    }
    html[data-theme="light"] .engine-btn[data-active="true"]{
      background:rgba(47,107,255,.15);
      border-color:rgba(47,107,255,.45);
      color:#0f172a;
    }
    .engine-icon{
      width:18px; height:18px; border-radius:4px; display:inline-block;
      background:linear-gradient(135deg,#89a7ff,#4285F4);
    }

    .search-bar{ display:flex; gap:12px; text-align:center; }
    .input-shell{
      display:flex; align-items:center; gap:10px; flex:1;
      background:var(--surface); border:1px solid var(--border-strong);
      border-radius:12px; 
      padding: 8px 12px; 
      max-width:100%;
    }
    .input-shell input{
      flex:1; font-size:16px; background:transparent; color:var(--ink-0);
      border:none; outline:none; text-align:left;
    }
    .search-btn{
      background:var(--primary); color:#fff; border:none; font-weight:800;
      border-radius:12px; padding:12px 16px; cursor:pointer;
      transition:transform .12s ease, background-color .2s ease;
      letter-spacing:.2px; white-space:nowrap;
    }
    .search-btn:hover{ background:var(--primary-2); transform:translateY(-1px); }
    .input-shell .search-btn { padding: 8px 14px; border-radius: 10px; font-size: 15px; font-weight: 500; }

    @media (max-width:720px){
      :root{ --mobile-gutter:14px; }
      header{ padding-left:var(--mobile-gutter); padding-right:var(--mobile-gutter); }
      main{ padding-left:var(--mobile-gutter); padding-right:var(--mobile-gutter); padding-top: 60px; }
      .section{ margin:16px 0; border-radius:14px; }
      .section-body{ padding:16px; }
      
      .time-text { font-size: 14px; gap: 6px; } 
      .time-text .t-time { font-size: 14px; font-weight: 900; }

      .link-grid{ grid-template-columns: repeat(3, 1fr); gap: 10px; }
      .link-grid.grid-4{ grid-template-columns: repeat(2, 1fr); }
      .link{
        flex-direction: column; justify-content: center; align-items: center;
        gap: 6px; padding: 10px 8px; min-height: 80px;
      }
      .link img{ width: 32px; height: 32px; }
      .link span{
        font-size: 12px; font-weight: 500; text-align: center;
        white-space: normal; line-height: 1.2;
      }
      .drawer-nav{ width:280px; }
      .engine-btn{ font-size:12px; padding:7px 10px; }
      .input-shell{ padding: 8px 10px; border-radius: 10px; display:flex; align-items:center; }
      .input-shell input{ font-size:15px; padding:0; text-align:left; }
      .search-btn{ padding:8px 14px; border-radius:10px; }
      summary.section-title .cal-sans-regular { font-size: 17px; }
    }

    @media (max-width:360px){
      :root{ --mobile-gutter:10px; }
      .section-body{ padding:14px; }
      .time-text { font-size: 13px; } 
      .time-text .t-time { font-size: 13px; }
    }

    /* --- Scroll Buttons --- */
    .scroll-btn{
      position:fixed; right:18px; width:42px; height:42px;
      border:none; border-radius:12px; background:rgba(17,22,29,.8);
      display:flex; align-items:center; justify-content:center;
      cursor:pointer; z-index:900; box-shadow:0 6px 18px var(--shadow);
      color:#fff; border:1px solid var(--border);
      opacity:1; transform:translateY(0);
      transition:opacity .2s, transform .2s, background .2s;
    }
    html[data-theme="light"] .scroll-btn{
      background:rgba(2,6,23,.65);
      border-color:rgba(2,6,23,.20);
    }
    .scroll-btn.up{ bottom:82px; }
    .scroll-btn.down{ bottom:28px; }
    .scroll-btn:hover{ background:rgba(23,29,38,.9); }
    .scroll-btn.hidden{ opacity:0; pointer-events:none; transform:translateY(8px); }

    /* --- Footer --- */
    footer{
      color:var(--ink-1); 
      text-align:center; 
      padding:18px 0 24px; 
      font-size:13px; 
      opacity:.9;
      line-height: 1.6;
    }
    footer span:last-child {
      font-size: 0.9em;
      opacity: 0.8;
    }
    @media (max-width:720px){
      footer { font-size: 12px; }
    }
    .section .link img{ width: 26px; height: 26px; object-fit: contain; }
    @media (max-width: 720px){
      .section .link img{ width: 36px; height: 36px; }
    }

    /* --- Notice Bar --- */
    .notice-bar {
      background: var(--surface);
      border: 1px solid var(--border-strong);
      border-radius: 12px;
      margin: 18px auto;
      padding: 6px 12px;
      max-width: var(--maxw);
      box-shadow: 0 6px 16px var(--shadow);
      overflow: hidden;
      position: relative;
    }
    .notice-inner { display:flex; align-items:center; gap:12px; }
    .notice-label {
      font-weight:900; font-size:14px; padding:4px 8px; border-radius:6px; flex-shrink:0;
      background:#facc15; color:#0c0f14;
    }
    html[data-theme="light"] .notice-label { background:#3b82f6; color:white; }
    .notice-marquee { 
      flex:1; overflow:hidden; position:relative; height:24px; 
      mask-image: linear-gradient(to right, transparent, black 10px, black calc(100% - 10px), transparent);
      -webkit-mask-image: linear-gradient(to right, transparent, black 10px, black calc(100% - 10px), transparent);
    }
    .notice-text {
      display:inline-block; white-space:nowrap; font-size:14px; font-weight:500;
      position: absolute;
      animation: marquee 20s linear infinite;
      animation-delay: -5s; 
      will-change: transform;
    }
    
    @keyframes marquee {
      0%    { transform: translateX(100%); }
      100% { transform: translateX(-100%); }
    }
    @media (prefers-reduced-motion: reduce){
      .notice-text{ animation:none; position: relative; }
    }
    @media (max-width: 720px) {
        .notice-text { 
            animation-duration: 12s; 
            animation-delay: -3s; 
        }
    }

    .notice-close{
      appearance:none; background:transparent; border:none; color:var(--ink-0);
      font-size:18px; font-weight:bold; cursor:pointer; padding:0 6px;
    }
    .notice-close:hover{ color:var(--primary); }

    /* --- Accordion (Details/Summary) --- */
    summary.section-title {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background-color: rgba(255, 255, 255, 0.05);
      padding: 12px 16px;
      border-radius: 8px;
      cursor: pointer;
      transition: background-color 0.2s ease;
      list-style: none; 
    }
    @media (min-width: 721px) {
      summary.section-title .cal-sans-regular { font-size: 19px; }
    }
    summary.section-title::-webkit-details-marker { display: none; }
    summary.section-title:hover { background-color: rgba(255, 255, 255, 0.1); }
    [data-theme="light"] summary.section-title { background-color: rgba(0, 0, 0, 0.05); }
    [data-theme="light"] summary.section-title:hover { background-color: rgba(0, 0, 0, 0.1); }

    .fold-icon {
      width: 24px; height: 24px;
      color: var(--ink-0); opacity: 0.7;
      transition: transform 0.2s ease-in-out;
    }
    details[open] > summary.section-title .fold-icon { transform: rotate(180deg); }
    
    .details-content-wrapper {
      display: grid;
      grid-template-rows: 0fr;
      overflow: hidden;
      transition: grid-template-rows 0.3s ease-out;
    }
    /* Animation Trigger */
    details[open]:not(.closing) .details-content-wrapper { grid-template-rows: 1fr; }
    
    /* Ensure children have min-height for grid animation to work */
    .details-content-wrapper > * {
      min-height: 0;
    }

    /* --- Music Card Style (Fix for animation) --- */
    .music-card {
      margin-top: 16px; 
      width: 100%; 
      height: 80px; 
      border-radius: 12px; 
      overflow: hidden; 
      border: 1px solid var(--border-strong);
    }
    
    /* Add margin to grid child as well */
    .details-content-wrapper > .link-grid {
      margin-top: 16px;
    }
    .details-content-wrapper > .stopwatch-wrap {
      /* Stopwatch handles its own spacing internally/via flex */
    }

    /* --- Icons --- */
    .external-icon {
      width: 18px; height: 18px;
      margin-right: 8px;
      vertical-align: middle;
      color: var(--ink-1);
      opacity: 0.8;
    }
    summary.section-title:hover .external-icon { opacity: 1; color: var(--primary); }

    /* --- Stopwatch UI --- */
    .stopwatch-wrap {
      display: flex;
      flex-direction: column;
      margin-top: 16px;
      gap: 0;
      transition: padding-top 0.4s ease;
    }
    .sw-main-panel {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      transition: flex-grow 0.4s cubic-bezier(0.25, 0.8, 0.25, 1); 
    }

    /* Lap Animations */
    @keyframes slideDown {
        from { opacity: 0; transform: translateY(-15px); }
        to { opacity: 1; transform: translateY(0); }
    }
    @keyframes fadeInUp {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
    }
    @keyframes slideUpFade {
        to { opacity: 0; transform: translateY(-10px); }
    }

    @media (min-width: 721px) {
      .stopwatch-wrap {
        flex-direction: row;
        align-items: flex-start;
        justify-content: center; 
        width: 100%;
      }
      .sw-main-panel {
        width: 100%;
        flex: 1 1 auto;
        transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
        border-right: 1px solid transparent;
      }
      .stopwatch-wrap.has-laps .sw-main-panel {
        width: 50%; flex: 0 0 50%; align-items: center;
      }
      .stopwatch-wrap.has-laps .lap-list-container {
        display: block; flex: 1 1 auto; width: 50%; 
        opacity: 1; border-left: 1px solid var(--border-strong);
        padding-left: 20px; animation: fadeInRight 0.4s ease forwards; 
      }
      .lap-list-container {
        display: none; margin-top: 0 !important; border-top: none !important;
        padding-top: 0; opacity: 0; width: 0; overflow: hidden;
        transition: opacity 0.4s ease, width 0.4s ease, padding-left 0.4s ease, flex-grow 0.4s ease;
      }
      .lap-list-container.closing {
        width: 0 !important; 
        padding-left: 0 !important;
        flex-grow: 0.0001 !important; 
        opacity: 0 !important; 
      }
    }

    @keyframes fadeInRight {
        from { opacity: 0; transform: translateX(20px); }
        to { opacity: 1; transform: translateX(0); }
    }

    .stopwatch-display {
      font-variant-numeric: tabular-nums;
      font-size: 36px;
      font-weight: 700;
      letter-spacing: 2px;
      margin-bottom: 16px;
      color: var(--ink-0);
    }
    .timer-controls {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-bottom: 10px;
      flex-wrap: wrap; 
    }
    .timer-btn {
      padding: 10px 0; 
      border-radius: 12px;
      font-size: 15px;
      font-weight: 600;
      border: 1px solid var(--border-strong);
      cursor: pointer;
      transition: all 0.2s;
      background: var(--surface);
      color: var(--ink-0);
      width: 100px; 
      text-align: center;
      touch-action: manipulation;
      display: inline-flex; align-items: center; justify-content: center; 
    }
    .timer-btn:hover { transform: translateY(-1px); background: var(--surface-hover); }
    .timer-btn.btn-start { background: rgba(47,107,255,0.15); border-color: rgba(47,107,255,0.4); color: var(--primary); }
    html[data-theme="light"] .timer-btn.btn-start { color: var(--primary-2); }
    .timer-btn.btn-stop { background: rgba(255,90,90,0.1); border-color: rgba(255,90,90,0.3); color: #ff5a5a; }
    
    .lap-list-container {
      margin-top: 16px;
      border-top: 1px solid var(--border-strong);
      padding-top: 12px;
      text-align: left;
      max-height: 130px; 
      overflow-y: auto;
      display: none; 
    }
    .lap-list-container.active {
      display: block;
      animation: fadeInUp 0.4s ease forwards; 
    }
    .lap-item.exiting {
        animation: slideUpFade 0.3s ease forwards;
    }

    .lap-item {
      display: flex;
      justify-content: space-between;
      padding: 8px 12px;
      font-size: 14px;
      color: var(--ink-1);
      border-bottom: 1px solid rgba(255,255,255,0.03);
      background: rgba(255,255,255,0.02);
      border-radius: 8px;
      margin-bottom: 6px;
      animation: slideDown 0.3s ease forwards;
    }
    .lap-item:last-child { margin-bottom: 0; }
    html[data-theme="light"] .lap-item { background: rgba(0,0,0,0.02); border-bottom: 1px solid rgba(0,0,0,0.03); }
    .lap-index { font-weight: 700; color: var(--focus); width: 60px; }

    /* --- Fullscreen Mode --- */
    .fullscreen-mode {
        position: fixed;
        top: 0; left: 0;
        width: 100vw; height: 100vh;
        z-index: 9999;
        background-color: var(--bg-1);
        padding: 20px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: flex-start;
        padding-top: 35vh; 
        overflow-y: auto;
        box-sizing: border-box;
        margin: 0 !important; 
        border-radius: 0 !important;
        animation: fsEnter 0.3s cubic-bezier(0.22, 1, 0.36, 1) forwards;
    }
    
    .fullscreen-mode.has-laps {
        padding-top: 15vh; 
    }

    @keyframes fsEnter {
        from { opacity: 0; transform: scale(0.95); }
        to { opacity: 1; transform: scale(1); }
    }
    
    .fullscreen-closing {
        animation: fsExit 0.3s cubic-bezier(0.22, 1, 0.36, 1) forwards !important;
        position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
        z-index: 9999;
        background-color: var(--bg-1);
        display: flex; flex-direction: column; align-items: center; justify-content: center;
    }
    
    @keyframes fsExit {
        from { opacity: 1; transform: scale(1); }
        to { opacity: 0; transform: scale(0.95); }
    }

    .fullscreen-mode .sw-main-panel {
        width: 100% !important;
        flex: 0 0 auto !important;
        margin-bottom: 30px;
        max-width: 600px; 
    }

    .fullscreen-mode .stopwatch-display {
        font-size: clamp(60px, 15vw, 150px); 
        margin-bottom: 40px;
    }

    .fullscreen-mode .timer-btn {
        padding: 14px 0;
        font-size: 18px;
        width: 120px;
        border-radius: 14px;
    }

    .fullscreen-mode .lap-list-container {
        width: 100% !important;
        max-width: 600px;
        border-left: none !important;
        border-top: 1px solid var(--border-strong) !important;
        padding-left: 0 !important;
        padding-top: 20px !important;
        max-height: 165px; 
        flex: 0 0 auto;
        min-height: 0; 
        overflow-y: auto;
    }
    
    .fs-btn-icon {
        width: 54px;
        color: var(--ink-1);
        padding: 10px 0;
        flex: 0 0 auto;
    }
    .fs-btn-icon:hover { color: var(--ink-0); }
    
    .fullscreen-mode .timer-btn.fs-btn-icon {
        width: 60px;
    }

  </style>
</head>

<body>
  <header>
    <div class="head-inner">
      <h1 id="headerTitle">
        <span class="cal-sans-regular">WebHub</span>
        <span class="brand-by">by Seungmin Woo</span>
      </h1>
      <button id="themeToggle" class="theme-toggle" aria-label="테마 전환" aria-pressed="false" title="테마 전환">
        <svg id="iconMoon" width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
          <path d="M21 12.79A9 9 0 1 1 11.21 3a7 7 0 1 0 9.79 9.79Z" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        <svg id="iconSun" width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true" style="display:none">
          <circle cx="12" cy="12" r="4.5" stroke="currentColor" stroke-width="1.6"/>
          <path d="M12 2v2M12 20v2M4 12H2M22 12h-2M5 5l-1.4-1.4M20.4 20.4 19 19M19 5l1.4-1.4M3.6 20.4 5 19" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/>
        </svg>
      </button>
      <button class="menu-toggle" aria-controls="drawerNav" aria-expanded="false" aria-label="메뉴 열기" title="메뉴 열기">
        <span class="hamburger" aria-hidden="true"><span></span><span></span><span></span></span>
      </button>
    </div>
  </header>

  <div class="drawer-root" id="drawerRoot" aria-hidden="true">
    <div class="drawer-overlay" id="drawerOverlay"></div>
    <nav id="drawerNav" class="drawer-nav" role="navigation" aria-label="오프캔버스 메뉴">
      <button class="drawer-close-btn" aria-label="메뉴 닫기" title="메뉴 닫기">×</button>
      <div class="cal-sans-regular">
        <h3>M E N U</h3>
        <ul>
          <li><a href="/" rel="noopener noreferrer">Home</a></li>
          <li><a href="/admin/" target="_blank" rel="noopener noreferrer">Admin</a></li>
          <li><a href="https://github.com/" target="_blank" rel="noopener noreferrer">Github</a></li>
          <li><a href="/testbridge/" target="_blank" rel="noopener noreferrer">Laboratory</a></li>
        </ul>
        <br>
        <h3>O T H E R S</h3>
        <ul>
          <li><a href="/jejubus/" target="_blank" rel="noopener noreferrer">Jeju Bus Timetable</a></li>
        </ul>
      </div>
    </nav>
  </div>

  <main>
    <section class="section" aria-labelledby="timeSectionTitle">
      <div class="section-body">
        <div class="time-text" id="currentDateTime"></div>
      </div>
    </section>

    <section class="section" aria-labelledby="searchTitle">
      <div class="section-body">
        <div class="search-wrap">
          <div class="engine-seg" id="engineSeg" aria-label="검색 대상 선택">
            <button type="button" class="engine-btn" data-engine="google" data-active="true" aria-pressed="true">
              <span class="engine-icon" style="background:linear-gradient(135deg,#7db3ff,#4285F4)"></span> Google
            </button>
            <button type="button" class="engine-btn" data-engine="naver" aria-pressed="false">
              <span class="engine-icon" style="background:linear-gradient(135deg,#34d399,#03cf5d)"></span> NAVER
            </button>
            <button type="button" class="engine-btn" data-engine="youtube" aria-pressed="false">
              <span class="engine-icon" style="background:linear-gradient(135deg,#ff8a8a,#ff0000)"></span> YouTube
            </button>
            <button type="button" class="engine-btn" data-engine="namu" aria-pressed="false">
              <span class="engine-icon" style="background:linear-gradient(135deg,#00d5c0,#00a495)"></span> 나무위키
            </button>
            <button type="button" class="engine-btn" data-engine="cbnul" aria-pressed="false">
              <span class="engine-icon" style="background:linear-gradient(135deg,#ff8fb1,#B52555)"></span> 충북대학교 도서관
            </button>
            <button type="button" class="engine-btn" data-engine="wikipedia" aria-pressed="false">
              <span class="engine-icon" style="background:linear-gradient(135deg,#bbbbbb,#191919)"></span> 위키백과
            </button>
            <button type="button" class="engine-btn" data-engine="dbpia" aria-pressed="false">
              <span class="engine-icon" style="background:linear-gradient(135deg,#ffa3a6,#cf393e)"></span> DBpia
            </button>
            <button type="button" class="engine-btn" data-engine="riss" aria-pressed="false">
              <span class="engine-icon" style="background:linear-gradient(135deg,#ff9a76,#F76323)"></span> RISS
            </button>
            <button type="button" class="engine-btn" data-engine="everytime" aria-pressed="false">
              <span class="engine-icon" style="background:linear-gradient(135deg,#ff6b6b,#f91f15)"></span> 에브리타임
            </button>
          </div>

          <div class="search-bar" role="search" aria-label="통합 검색">
            <div class="input-shell">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                <path d="M21 21l-3.9-3.9M10.5 18a7.5 7.5 0 1 1 0-15 7.5 7.5 0 0 1 0 15Z" stroke="#8aa2c2" stroke-width="2" stroke-linecap="round"/>
              </svg>
              <input id="q" type="search" placeholder="검색어를 입력하세요" aria-label="검색어 입력" autocomplete="off" />
              <button id="searchBtn" class="search-btn" type="button" title="검색">검색</button>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="section">
      <div class="section-body">
        
        <details open>
          <summary class="section-title">
            <div>
                <svg class="external-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg>
                <span class="cal-sans-regular">Educational Volunteering</span>
            </div>
            <svg class="fold-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M6 9L12 15L18 9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </summary>
          <div class="details-content-wrapper">
            <div class="link-grid grid-4">
              <a class="link" href="https://www.cbnu.ac.kr/www/selectBbsNttList.do?bbsNo=8&key=813" target="_blank" rel="noopener noreferrer">
                <img src="https://www.google.com/s2/favicons?sz=32&domain=eis.cbnu.ac.kr" alt="" loading="lazy" decoding="async" aria-hidden="true">
                <span>충북대 공지사항</span>
              </a>
              <a class="link" href="https://www.knue.ac.kr/www/selectBbsNttList.do?bbsNo=26&key=807" target="_blank" rel="noopener noreferrer">
                <img src="https://www.google.com/s2/favicons?sz=32&domain=knue.ac.kr" alt="" loading="lazy" decoding="async" aria-hidden="true">
                <span>교원대 공지사항</span>
              </a>
              <a class="link" href="https://www.1365.go.kr/vols/1572247904127/partcptn/timeCptn.do" target="_blank" rel="noopener noreferrer">
                <img src="https://www.google.com/s2/favicons?sz=32&domain=1365.go.kr" alt="" loading="lazy" decoding="async" aria-hidden="true">
                <span>자원봉사포털</span>
              </a>
              <a class="link" href="https://edu.chungbuk.ac.kr/teaching/selectBbsNttList.do?key=549&bbsNo=101" target="_blank" rel="noopener noreferrer">
                <img src="https://www.google.com/s2/favicons?sz=32&domain=eis.cbnu.ac.kr" alt="" loading="lazy" decoding="async" aria-hidden="true">
                <span>교직부 공지사항</span>
              </a>
            </div>
          </div>
        </details>

        <hr class="group-divider">

        <details>
          <summary class="section-title">
            <div>
                <svg class="external-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg>
                <span class="cal-sans-regular">Chungbuk National University</span>
            </div>
            <svg class="fold-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M6 9L12 15L18 9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </summary>
          <div class="details-content-wrapper">
            <div class="link-grid grid-4">
              <a class="link" href="https://lms.chungbuk.ac.kr/" target="_blank" rel="noopener noreferrer">
                <img src="https://www.google.com/s2/favicons?sz=32&domain=eis.cbnu.ac.kr" alt="" loading="lazy" decoding="async" aria-hidden="true">
                <span>eCampus</span>
              </a>
              <a class="link" href="https://eis.cbnu.ac.kr/cbnuLogin?1613652726" target="_blank" rel="noopener noreferrer">
                <img src="https://www.google.com/s2/favicons?sz=32&domain=eis.cbnu.ac.kr" alt="" loading="lazy" decoding="async" aria-hidden="true">
                <span>개신누리</span>
              </a>
              <a class="link" href="https://cieat.chungbuk.ac.kr/" target="_blank" rel="noopener noreferrer">
                <img src="https://www.google.com/s2/favicons?sz=32&domain=cieat.chungbuk.ac.kr" alt="" loading="lazy" decoding="async" aria-hidden="true">
                <span>CIEAT</span>
              </a>
              <a class="link" href="https://eisa.cbnu.ac.kr/atlecLogin" target="_blank" rel="noopener noreferrer">
                <img src="https://www.google.com/s2/favicons?sz=32&domain=eis.cbnu.ac.kr" alt="" loading="lazy" decoding="async" aria-hidden="true">
                <span>수강신청</span>
              </a>
            </div>
          </div>
        </details>

      </div>
    </section>

    <section class="section">
      <div class="section-body">
        <details>
          <summary class="section-title">
            <div>
              <svg class="external-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 18V5l12-2v13"></path><circle cx="6" cy="18" r="3"></circle><circle cx="18" cy="16" r="3"></circle></svg>
              <span class="cal-sans-regular">Music</span>
            </div>
            <svg class="fold-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M6 9L12 15L18 9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </summary>
          <div class="details-content-wrapper">
            <div class="music-card">
              <iframe width="100%" height="100%" src="https://www.youtube.com/embed/2BegA7SRYIQ?controls=1&modestbranding=1" title="Music" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
            </div>
          </div>
        </details>
      </div>
    </section>

    <section class="section">
      <div class="section-body">
        <details>
          <summary class="section-title">
            <div>
                <svg class="external-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
                <span class="cal-sans-regular">Stopwatch</span>
            </div>
            <svg class="fold-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M6 9L12 15L18 9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </summary>
          <div class="details-content-wrapper">
            <div class="stopwatch-wrap" id="stopwatchWrapper">
              <div class="sw-main-panel">
                <div id="stopwatchDisplay" class="stopwatch-display">00:00:00</div>
                <div class="timer-controls">
                  <button id="btnMain" class="timer-btn btn-start">시작</button>
                  <button id="btnSub" class="timer-btn">초기화</button>
                  <button id="btnFullscreenControl" class="timer-btn fs-btn-icon" title="전체화면" aria-label="전체화면">
                    <svg id="iconExpand" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M15 3h6v6M9 21H3v-6M21 3l-7 7M3 21l7-7"/>
                    </svg>
                    <svg id="iconCompress" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display:none">
                        <path d="M8 3v3a2 2 0 0 1-2 2H3m18 0h-3a2 2 0 0 1-2-2V3m0 18v-3a2 2 0 0 1 2-2h3M3 16h3a2 2 0 0 1 2 2v3"/>
                    </svg>
                  </button>
                </div>
              </div>
              <div class="lap-list-container" id="lapList"></div>
            </div>
          </div>
        </details>
      </div>
    </section>

    <section class="section">
      <div class="section-body">
        <details>
          <summary class="section-title">
            <div>
                <svg class="external-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg>
                <span class="cal-sans-regular">Artificial Intelligence</span>
            </div>
            <svg class="fold-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M6 9L12 15L18 9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </summary>
          <div class="details-content-wrapper">
            <div class="link-grid grid-4">
              <a class="link" href="https://gemini.google.com/" target="_blank" rel="noopener noreferrer">
                <img src="https://www.google.com/s2/favicons?sz=32&domain=gemini.google.com" alt="" loading="lazy" decoding="async" aria-hidden="true">
                <span>Gemini</span>
              </a>
              <a class="link" href="http://chat.openai.com/" target="_blank" rel="noopener noreferrer">
                <img src="https://www.google.com/s2/favicons?sz=32&domain=chat.openai.com" alt="" loading="lazy" decoding="async" aria-hidden="true">
                <span>ChatGPT</span>
              </a>
              <a class="link" href="http://www.claude.ai/" target="_blank" rel="noopener noreferrer">
                <img src="https://www.google.com/s2/favicons?sz=32&domain=claude.ai" alt="" loading="lazy" decoding="async" aria-hidden="true">
                <span>Claude</span>
              </a>
              <a class="link" href="https://www.perplexity.ai/" target="_blank" rel="noopener noreferrer">
                <img src="https://www.google.com/s2/favicons?sz=32&domain=perplexity.ai" alt="" loading="lazy" decoding="async" aria-hidden="true">
                <span>Perplexity</span>
              </a>
            </div>
          </div>
        </details>
      </div>
    </section>

    <section class="notice-bar" id="noticeBar" aria-label="공지사항">
      <div class="notice-inner">
        <span class="notice-label">NOTICE</span>
        <div class="notice-marquee">
          <div class="notice-text">
            버전 4.5.5 업데이트 완료. 이제 스톱워치 기능이 추가되었으며, 단축키(Space, L, Esc)를 지원합니다.
          </div>
        </div>
        <button class="notice-close" aria-label="공지 닫기">×</button>
      </div>
    </section>
  </main>

  <footer>
    <span class="cal-sans-regular">WebHub  Ver. 4.5.5</span><br>
    <span>&copy; 2025 우승민. All rights reserved.</span>
  </footer>

  <button class="scroll-btn up hidden" aria-label="맨 위로" title="맨 위로">▲</button>
  <button class="scroll-btn down hidden" aria-label="맨 아래로" title="맨 아래로">▼</button>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const headerTitle = document.getElementById('headerTitle');
      const menuToggle  = document.querySelector('.menu-toggle');
      const drawerRoot  = document.getElementById('drawerRoot');
      const drawerNav   = document.getElementById('drawerNav');
      const overlay     = document.getElementById('drawerOverlay');
      const drawerCloseBtn = document.querySelector('.drawer-close-btn');
      const currentDateTimeElement = document.getElementById('currentDateTime');
      const engineSeg  = document.getElementById('engineSeg');
      const q          = document.getElementById('q');
      const searchBtn  = document.getElementById('searchBtn');
      const themeToggleBtn = document.getElementById('themeToggle');
      const iconMoon = document.getElementById('iconMoon');
      const iconSun  = document.getElementById('iconSun');
      const THEME_KEY = 'theme';

      headerTitle?.addEventListener('click', () => location.reload());

      // --- Clock Logic ---
      function getCurrentDateTime(){
        const now=new Date();
        const y=now.getFullYear();
        const m=now.getMonth()+1; 
        const d=now.getDate();    
        const wd=['일','월','화','수','목','금','토'][now.getDay()];
        const h=now.getHours();
        const ap=h>=12?'오후':'오전';
        const hh=h%12||12;
        const mm=now.getMinutes(); 
        const ss=now.getSeconds(); 
        
        return `<span class="t-date">${y}년 ${m}월 ${d}일 ${wd}요일</span> <span class="t-time">${ap} ${hh}시 ${mm}분 ${ss}초</span>`;
      }
      function displayCurrentDateTime(){ currentDateTimeElement.innerHTML = getCurrentDateTime(); }
      displayCurrentDateTime(); setInterval(displayCurrentDateTime, 1000);

      // --- Drawer & Scroll Lock ---
      let savedScrollPosition = 0;
      function lockBody(){ 
        savedScrollPosition = window.scrollY;
        document.body.style.top = `-${savedScrollPosition}px`;
        document.body.classList.add('scroll-lock'); 
      }
      function unlockBody(){ 
        document.documentElement.style.scrollBehavior = 'auto';
        document.body.classList.remove('scroll-lock'); 
        document.body.style.top = '';
        window.scrollTo(0, savedScrollPosition);
        setTimeout(() => {
            document.documentElement.style.scrollBehavior = '';
        }, 50);
      }

      function setDrawer(open){
        if (open){
          drawerRoot.classList.add('active');
          drawerRoot.setAttribute('aria-hidden','false');
          menuToggle.setAttribute('aria-expanded','true');
          lockBody();
          drawerNav.querySelector('a, button')?.focus();
        }else{
          drawerRoot.classList.remove('active');
          drawerRoot.setAttribute('aria-hidden','true');
          menuToggle.setAttribute('aria-expanded','false');
          unlockBody(); 
          menuToggle.focus();
        }
      }
      menuToggle.addEventListener('click',()=> setDrawer(!drawerRoot.classList.contains('active')));
      overlay.addEventListener('click',()=> setDrawer(false));
      drawerCloseBtn.addEventListener('click',()=> setDrawer(false));
      document.addEventListener('keydown',e=>{ 
          if(e.key==='Escape') {
              // Handle ESC key for various overlays
              if(drawerRoot.classList.contains('active')) {
                  setDrawer(false);
              } else if (stopwatchWrap.classList.contains('fullscreen-mode')) {
                  toggleFullscreen();
              } else if (q.value !== '') {
                  q.value = ''; 
              }
          }
      });
      document.addEventListener('click',e=>{
        if(!drawerRoot.classList.contains('active')) return;
        const insidePanel = drawerNav.contains(e.target);
        const onToggle = menuToggle.contains(e.target);
        if(!insidePanel && !onToggle) setDrawer(false);
      });

      // --- Search Engine Logic ---
      let currentEngine='google';
      const cmap={ 
        google:'#4285F4', naver:'#03cf5d', youtube:'#ff0000', namu:'#00a495', 
        cbnul:'#B52555', wikipedia:'#191919', dbpia:'#cf393e', riss:'#F76323', everytime:'#f91f15'
      };
      function syncEngineUI(engine){
        currentEngine=engine;
        [...engineSeg.querySelectorAll('.engine-btn')].forEach(b=>{
          const active = b.dataset.engine===engine;
          b.dataset.active=String(active);
          b.setAttribute('aria-pressed', String(active));
        });
        searchBtn.style.backgroundColor = cmap[engine] || 'var(--primary)';
      }
      engineSeg.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') {
          const btn = e.target.closest('.engine-btn'); if(btn) syncEngineUI(btn.dataset.engine);
        }
      });
      let isPointerDown=false, isDragging=false, dragStartX=0, dragStartScroll=0, pointerDownTarget=null;
      const dragThreshold = 4; 
      engineSeg.addEventListener('pointerdown', (ev) => {
        if (ev.pointerType === 'mouse' && ev.button !== 0) return;
        isPointerDown = true; isDragging = false;
        dragStartX = ev.clientX; dragStartScroll = engineSeg.scrollLeft;
        pointerDownTarget = ev.target.closest('.engine-btn');
        engineSeg.classList.add('dragging');
        try { engineSeg.setPointerCapture(ev.pointerId); } catch(e){}
      }, { passive: true });
      engineSeg.addEventListener('pointermove', (ev) => {
        if (!isPointerDown) return;
        const dx = ev.clientX - dragStartX;
        if (!isDragging && Math.abs(dx) > dragThreshold) isDragging = true;
        if (isDragging) {
          ev.preventDefault();
          engineSeg.scrollLeft = dragStartScroll - dx;
        }
      });
      function handlePointerEnd(ev){
        if (!isPointerDown) return;
        if (!isDragging) {
          const btn = pointerDownTarget || ev.target.closest('.engine-btn');
          if (btn) syncEngineUI(btn.dataset.engine);
        }
        isPointerDown = false; isDragging = false; pointerDownTarget = null;
        engineSeg.classList.remove('dragging');
        try { if(ev && ev.pointerId) engineSeg.releasePointerCapture(ev.pointerId); } catch(e){}
      }
      engineSeg.addEventListener('pointerup', handlePointerEnd);
      engineSeg.addEventListener('pointercancel', handlePointerEnd);
      engineSeg.addEventListener('mouseleave', (ev) => {
        if (isPointerDown && ev.pointerType === 'mouse') handlePointerEnd(ev);
      });
      syncEngineUI(currentEngine);
      function buildSearchURL(engineKey, term){
        const t=(term||'').trim(); if(!t) return null;
        try{
          switch(engineKey){
            case 'google':   { const u=new URL('https://www.google.com/search'); u.search=new URLSearchParams({q:t}).toString(); return u.toString(); }
            case 'naver':    { const u=new URL('https://search.naver.com/search.naver'); u.search=new URLSearchParams({query:t}).toString(); return u.toString(); }
            case 'youtube':  { const u=new URL('https://www.youtube.com/results'); u.search=new URLSearchParams({search_query:t}).toString(); return u.toString(); }
            case 'namu':     { const u=new URL('https://namu.wiki/w/'); u.pathname+=encodeURIComponent(t); return u.toString(); }
            case 'cbnul':    { const u=new URL('https://cbnul.chungbuk.ac.kr/search/i-discovery'); u.search=new URLSearchParams({ALL:`k|a|${t}`}).toString(); return u.toString(); }
            case 'wikipedia':{ const u=new URL('https://ko.wikipedia.org/w/index.php'); u.search=new URLSearchParams({search:t}).toString(); return u.toString(); }
            case 'dbpia':    { const u=new URL('https://www.dbpia.co.kr/search/topSearch'); u.search=new URLSearchParams({query:t}).toString(); return u.toString(); }
            case 'riss':     { const u=new URL('https://www.riss.kr/search/Search.do'); u.search=new URLSearchParams({
                                colName:'all', isDetailSearch:'N', searchGubun:'true', oldQuery:'', sflag:1,
                                fsearchMethod:'search', isFDetailSearch:'N', searchQuery:'', kbid:'', pageNumber:1, query:t
                              }).toString(); return u.toString(); }
            case 'everytime':{ return `https://everytime.kr/search/all/${encodeURIComponent(t)}`; }
            default: return null;
          }
        }catch{ return null; }
      }
      function doSearch(){
        const url = buildSearchURL(currentEngine, q.value); if(!url){ q.focus(); return; }
        window.open(url,'_blank','noopener');
      }
      searchBtn.addEventListener('click',doSearch);
      q.addEventListener('keydown',e=>{ if(e.key==='Enter'){ e.preventDefault(); doSearch(); } else if(e.key==='Escape'){ q.value=''; } });

      // --- Scroll Buttons ---
      const scrollBtnUp=document.querySelector('.scroll-btn.up');
      const scrollBtnDown=document.querySelector('.scroll-btn.down');
      function updateScrollButtons(){
        const scrollY = window.scrollY || window.pageYOffset;
        const atTop = scrollY <= 60;
        const atBottom = (window.innerHeight + scrollY) >= (document.body.scrollHeight - 60);
        if(atTop) scrollBtnUp.classList.add('hidden'); else scrollBtnUp.classList.remove('hidden');
        if(atBottom) scrollBtnDown.classList.add('hidden'); else scrollBtnDown.classList.remove('hidden');
      }
      updateScrollButtons();
      window.addEventListener('scroll', updateScrollButtons, { passive: true });
      window.addEventListener('resize', updateScrollButtons);
      scrollBtnUp?.addEventListener('click',()=>window.scrollTo({top:0,behavior:'smooth'}));
      scrollBtnDown?.addEventListener('click',()=>window.scrollTo({top:document.body.scrollHeight,behavior:'smooth'}));

      // --- Notice Bar ---
      document.addEventListener('click', (e) => {
        const btn = e.target.closest('.notice-close');
        if (!btn) return;
        btn.closest('#noticeBar')?.remove();
      });
      const s = document.createElement('style');
      s.textContent = `.notice-bar, .notice-close { pointer-events: auto; }`;
      document.head.appendChild(s);

      // --- Theme Manager ---
      function detectInitialTheme(){
        const saved = localStorage.getItem(THEME_KEY);
        return (saved === 'light' || saved === 'dark') ? saved : 'dark';
      }
      function applyTheme(theme){
        const root = document.documentElement;
        const themeMeta = document.querySelector('meta[name="theme-color"]');
        if (theme === 'light'){
          root.setAttribute('data-theme','light');
          themeToggleBtn?.setAttribute('aria-pressed','true');
          if(iconSun) iconSun.style.display='';
          if(iconMoon) iconMoon.style.display='none';
          themeMeta?.setAttribute('content','#ffffff');
        }else{
          root.removeAttribute('data-theme');
          themeToggleBtn?.setAttribute('aria-pressed','false');
          if(iconSun) iconSun.style.display='none';
          if(iconMoon) iconMoon.style.display='';
          themeMeta?.setAttribute('content','#0c0f14');
        }
        localStorage.setItem(THEME_KEY, theme);
      }
      function watchSystemTheme(){
        if (!window.matchMedia) return;
        const mq = window.matchMedia('(prefers-color-scheme: dark)');
        const handler = () => {
          const saved = localStorage.getItem(THEME_KEY);
          if (!saved){ applyTheme(mq.matches ? 'dark' : 'light'); }
        };
        if (mq.addEventListener) mq.addEventListener('change', handler);
        else mq.addListener(handler);
      }
      const initialTheme = detectInitialTheme();
      applyTheme(initialTheme);
      watchSystemTheme();
      themeToggleBtn?.addEventListener('click', () => {
        const isLight = document.documentElement.getAttribute('data-theme') === 'light';
        applyTheme(isLight ? 'dark' : 'light');
      });

      // --- Stopwatch Logic ---
      let swInterval = null;
      let swStartTime = 0;
      let swElapsedTime = 0;
      const swDisplay = document.getElementById('stopwatchDisplay');
      const btnMain = document.getElementById('btnMain'); 
      const btnSub = document.getElementById('btnSub');   
      const lapList = document.getElementById('lapList');
      const stopwatchWrap = document.querySelector('.stopwatch-wrap');
      const btnFullscreenControl = document.getElementById('btnFullscreenControl');
      const iconExpand = document.getElementById('iconExpand');
      const iconCompress = document.getElementById('iconCompress');
      let lapCounter = 1;

      function formatTime(ms) {
        const date = new Date(ms);
        const m = String(date.getUTCMinutes()).padStart(2, '0');
        const s = String(date.getUTCSeconds()).padStart(2, '0');
        const cs = String(Math.floor(date.getUTCMilliseconds() / 10)).padStart(2, '0');
        return `${m}:${s}:${cs}`;
      }
      function updateControls(isRunning) {
        if (isRunning) {
            btnMain.textContent = "중지";
            btnMain.classList.remove('btn-start');
            btnMain.classList.add('btn-stop');
            btnSub.textContent = "랩";
        } else {
            btnMain.textContent = "시작";
            btnMain.classList.remove('btn-stop');
            btnMain.classList.add('btn-start');
            btnSub.textContent = "초기화";
        }
      }
      function toggleLapContainer(show) {
        if (show) {
            lapList.classList.add('active');
            stopwatchWrap.classList.add('has-laps');
        } else {
            lapList.classList.remove('active');
            stopwatchWrap.classList.remove('has-laps');
        }
      }

      function toggleFullscreen() {
        const isFull = stopwatchWrap.classList.contains('fullscreen-mode');
        if (!isFull) {
            lockBody(); 
            stopwatchWrap.classList.add('fullscreen-mode');
            
            iconExpand.style.display = 'none';
            iconCompress.style.display = 'block';
            btnFullscreenControl.title = "원래대로";
            btnFullscreenControl.setAttribute('aria-label', "원래대로");
        } else {
            stopwatchWrap.classList.add('fullscreen-closing');
            
            setTimeout(() => {
                stopwatchWrap.classList.remove('fullscreen-mode');
                stopwatchWrap.classList.remove('fullscreen-closing');
                
                unlockBody();
                
                iconExpand.style.display = 'block';
                iconCompress.style.display = 'none';
                btnFullscreenControl.title = "전체화면";
                btnFullscreenControl.setAttribute('aria-label', "전체화면");
            }, 300); 
        }
      }
      
      btnFullscreenControl?.addEventListener('click', toggleFullscreen);

      btnMain?.addEventListener('click', () => {
        if (swInterval) {
            clearInterval(swInterval);
            swInterval = null;
            updateControls(false);
        } else {
            swStartTime = Date.now() - swElapsedTime;
            swInterval = setInterval(() => {
                swElapsedTime = Date.now() - swStartTime;
                swDisplay.textContent = formatTime(swElapsedTime);
            }, 10);
            updateControls(true);
        }
      });
      
      btnSub?.addEventListener('click', () => {
        if (swInterval) {
            if (!stopwatchWrap.classList.contains('has-laps')) {
                toggleLapContainer(true);
            }
            const li = document.createElement('div');
            li.className = 'lap-item';
            li.innerHTML = `<span class="lap-index">랩 ${lapCounter}</span> <span>${formatTime(swElapsedTime)}</span>`;
            lapList.prepend(li); 
            lapCounter++;
        } else {
            swElapsedTime = 0;
            swDisplay.textContent = "00:00:00";
            lapCounter = 1;

            const items = lapList.querySelectorAll('.lap-item');
            if (items.length > 0) {
                items.forEach(item => item.classList.add('exiting'));
                
                lapList.classList.add('closing');

                setTimeout(() => {
                    lapList.innerHTML = '';
                    lapList.classList.remove('closing');
                    toggleLapContainer(false); 
                }, 400);
            } else {
                toggleLapContainer(false);
            }
        }
      });

      // --- Accordion Logic (Details/Summary) ---
      // This automatically applies animation to the Music section as well
      const allDetails = document.querySelectorAll('details');

      allDetails.forEach((dt, index) => {
          const savedState = localStorage.getItem(`details_state_${index}`);
          if (savedState === 'open') {
              dt.setAttribute('open', '');
          } else if (savedState === 'closed') {
              dt.removeAttribute('open');
          }
      });

      allDetails.forEach((detail, index) => {
          const summary = detail.querySelector('summary');
          
          summary.addEventListener('click', (e) => {
              if (detail.hasAttribute('open')) {
                  e.preventDefault(); 
                  detail.classList.add('closing');
                  setTimeout(() => {
                      detail.removeAttribute('open');
                      detail.classList.remove('closing');
                      localStorage.setItem(`details_state_${index}`, 'closed');
                  }, 300);
              } else {
                  setTimeout(() => {
                        localStorage.setItem(`details_state_${index}`, 'open');
                  }, 0);
              }
          });
      });

      // --- Keyboard Shortcuts ---
      document.addEventListener('keydown', (e) => {
          if (document.activeElement === q) return;

          if (e.code === 'Space') {
              e.preventDefault(); 
              btnMain.click();
          }

          if (e.code === 'KeyL') {
              btnSub.click();
          }
      });

    });
  </script>
</body>
</html>
